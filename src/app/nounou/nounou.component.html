<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

  <section id="list-view" *ngIf="currentView === 'list-view'">

    <section class="mb-10 text-center md:text-left">
      <h2 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-2">
        Garde d'Enfants <span class="childcare-color">üß∏</span>
      </h2>
      <p class="text-xl text-gray-500">Trouvez une nounou ou assistante maternelle qualifi√©e pr√®s de chez vous.</p>
    </section>

    <form (ngSubmit)="applyFilters()" class="bg-white p-6 rounded-xl shadow-lg mb-8 border border-gray-100">
      <h3 class="text-xl font-bold text-gray-800 mb-4">Affiner votre recherche</h3>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <input type="text" placeholder="Ville ou quartier (ex: Dakar)"
               [(ngModel)]="filterLocation" name="location"
               class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
        <select [(ngModel)]="filterAge" name="age"
                class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 appearance-none">
          <option value="all">Toutes tranches d'√¢ge</option>
          <option value="bebe">B√©b√©s (0-2 ans)</option>
          <option value="maternelle">Maternelle (3-5 ans)</option>
          <option value="primaire">Primaire (6-12 ans)</option>
        </select>
        <div class="flex items-center space-x-2 p-3 bg-gray-50 rounded-lg">
          <input type="checkbox" [(ngModel)]="filterUrgent" name="urgent"
                 class="w-4 h-4 text-pink-600 border-gray-300 rounded focus:ring-pink-500">
          <label for="filter-urgent" class="text-gray-700">Disponible Imm√©diatement</label>
        </div>
        <button type="submit" class="px-6 py-3 bg-pink-600 text-white font-bold rounded-lg shadow-md hover:bg-pink-700 transition duration-300">
          Appliquer les Filtres
        </button>
      </div>
    </form>

    <section>
      <h3 class="text-2xl font-bold text-gray-800 mb-6">
        {{ filteredProviders.length }} Prestataire(s) trouv√©(s)
      </h3>

      <div class="space-y-6">
        <div *ngFor="let nanny of filteredProviders"
             class="provider-card bg-white p-6 rounded-xl shadow-lg border-l-4 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0"
             [ngClass]="{'border-pink-500': nanny.availability === 'now', 'border-gray-300': nanny.availability !== 'now'}"
             [attr.data-id]="nanny.id">

          <div class="flex items-center space-x-4 w-full md:w-auto">
            <div class="w-16 h-16 rounded-full border-2 border-pink-500 flex items-center justify-center text-xl font-bold text-white bg-pink-500">
              {{ nanny.imgText }}
            </div>
            <div>
              <a href="#" (click)="showDetails(nanny.id)" class="text-xl font-bold text-gray-900 hover:text-pink-600 transition">{{ nanny.name }}</a>
              <p class="text-gray-600">{{ nanny.title }}</p>
              <div class="flex items-center mt-1">
                <span class="text-sm font-bold mr-1 text-gray-800">{{ nanny.rating }}</span>
                <span [innerHTML]="generateStars(nanny.rating)"></span>
                <span class="text-sm text-gray-500 ml-2">({{ nanny.reviews }} Avis)</span>
              </div>
            </div>
          </div>

          <div class="flex flex-col items-start md:items-end space-y-2">
            <div [ngClass]="{
                'text-pink-700 bg-pink-100': nanny.availability === 'now',
                'text-gray-700 bg-gray-100': nanny.availability !== 'now'
              }"
                 class="availability-status flex items-center font-semibold px-3 py-1 rounded-full text-sm">
              <span *ngIf="nanny.availability === 'now'" class="relative flex h-2 w-2 mr-2">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-pink-400 opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-2 w-2 bg-pink-500"></span>
              </span>
              {{ getAvailabilityText(nanny.availability) }}
            </div>
            <p class="text-2xl font-bold text-pink-600">{{ nanny.rate }}</p>
            <button (click)="showDetails(nanny.id)" class="px-5 py-2 bg-pink-600 text-white font-semibold rounded-lg hover:bg-pink-700 transition duration-300">
              Contacter
            </button>
          </div>
        </div>
      </div>

      <div *ngIf="filteredProviders.length === 0" class="text-center p-8 bg-pink-50 rounded-lg border border-pink-200 mt-6">
        <p class="text-xl text-pink-800 font-semibold">Aucun prestataire ne correspond √† vos crit√®res.</p>
      </div>
    </section>
  </section>

  <section id="detail-view" *ngIf="currentView === 'detail-view' && selectedNanny">
    <button (click)="showView('list-view')" class="text-pink-600 hover:text-pink-800 font-semibold mb-6 flex items-center">
      Retour √† la liste
    </button>

    <div id="detail-content" class="bg-white p-8 rounded-xl shadow-2xl">
      <div class="flex flex-col md:flex-row items-center md:items-start space-y-6 md:space-y-0 md:space-x-8">
        <div class="w-32 h-32 rounded-full border-4 border-pink-500 flex items-center justify-center text-3xl font-bold text-white bg-pink-500">{{ selectedNanny.imgText }}</div>
        <div>
          <h2 class="text-3xl font-bold text-gray-900 mb-1">{{ selectedNanny.name }}</h2>
          <p class="text-xl text-pink-600 mb-2">{{ selectedNanny.title }}</p>
          <p class="text-gray-700 mb-4">{{ selectedNanny.profileContent }}</p>
          <p class="text-2xl font-bold text-pink-600 mb-4">Tarif: {{ selectedNanny.rate }}</p>

          <div class="mt-6">
            <div *ngIf="selectedNanny.availability === 'now'">
              <button (click)="simulateReservationDemand(selectedNanny.id)"
                      class="px-8 py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-lg hover:bg-indigo-700 transition duration-300">
                Faire une demande de r√©servation
              </button>
            </div>

            <div *ngIf="selectedNanny.availability !== 'now'" class="p-4 bg-gray-100 rounded-lg">
              <p class="text-lg font-semibold text-gray-700">
                R√©servation imm√©diate impossible. Statut: **{{ getAvailabilityText(selectedNanny.availability) }}**.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="reservationAccepted" class="mt-8 p-6 bg-pink-50 border border-pink-200 rounded-xl">
      <h3 class="text-2xl font-bold text-pink-800 mb-4">Demande accept√©e ! üéâ</h3>
      <p class="text-gray-700 mb-4">Votre demande de r√©servation a √©t√© **accept√©e** par
        <span class="font-bold">{{ selectedNanny.name }}</span>.
      </p>
      <p class="text-lg font-semibold text-gray-800 mb-4">Montant initial sugg√©r√© :
        <span class="text-pink-600 font-bold">{{ paymentAmount | number: '1.2-2' }} ‚Ç¨</span> (√† ajuster au paiement)
      </p>

      <button (click)="showPaymentForm(selectedNanny.id, paymentAmount)"
              class="px-8 py-3 bg-pink-600 text-white font-bold rounded-lg hover:bg-pink-700 transition duration-300 w-full md:w-auto">
        Effectuer le Paiement Maintenant
      </button>
    </div>
  </section>

  <section id="payment-view" *ngIf="currentView === 'payment-view' && selectedNanny">
    <button (click)="showView('detail-view')" class="text-pink-600 hover:text-pink-800 font-semibold mb-6 flex items-center">
      Annuler et revenir √† la demande
    </button>

    <div class="w-full max-w-lg mx-auto bg-white p-6 sm:p-8 rounded-xl shadow-2xl">

      <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Paiement S√©curis√© <span class="childcare-color">üîí</span></h1>
      <p class="text-center text-gray-500 mb-6">Paiement pour <span class="font-semibold text-pink-600">{{ selectedNanny.name }}</span></p>

      <div class="mb-6 border-b pb-4 border-indigo-100">
        <label for="payment-montant" class="block text-sm font-medium text-gray-700 mb-2">Montant √† Payer (en ‚Ç¨)</label>
        <div class="relative rounded-lg shadow-sm">
          <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
            <span class="text-gray-500 sm:text-sm font-semibold">‚Ç¨</span>
          </div>
          <input type="number" id="payment-montant" name="montant" placeholder="55.00" min="0.01" step="0.01" required
                 [(ngModel)]="paymentAmount"
                 class="block w-full rounded-lg border-2 border-indigo-300 py-3 pl-10 pr-4 text-gray-900 placeholder:text-gray-400 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm sm:leading-6 transition duration-150 ease-in-out">
        </div>
      </div>

      <h2 class="text-xl font-semibold text-gray-700 mb-4">Choisir la m√©thode de paiement</h2>

      <div class="space-y-4 mb-8">
        <label class="flex items-center p-4 bg-blue-50 border-2 rounded-xl cursor-pointer has-[:checked]:border-blue-600">
          <input type="radio" name="payment_method" value="carte"
                 [(ngModel)]="selectedPaymentMethod"
                 class="form-radio h-5 w-5 text-blue-600">
          <span class="ml-3 text-lg font-medium text-gray-800">Carte Bancaire</span>
        </label>

        <label class="flex items-center p-4 bg-orange-50 border-2 rounded-xl cursor-pointer has-[:checked]:border-orange-600">
          <input type="radio" name="payment_method" value="orange"
                 [(ngModel)]="selectedPaymentMethod"
                 class="form-radio h-5 w-5 text-orange-600">
          <span class="ml-3 text-lg font-medium text-gray-800">Orange-Money</span>
        </label>

        <label class="flex items-center p-4 bg-teal-50 border-2 rounded-xl cursor-pointer has-[:checked]:border-teal-600">
          <input type="radio" name="payment_method" value="wave"
                 [(ngModel)]="selectedPaymentMethod"
                 class="form-radio h-5 w-5 text-teal-600">
          <span class="ml-3 text-lg font-medium text-gray-800">Wave</span>
        </label>
      </div>

      <div id="specific-fields-container">

        <div *ngIf="selectedPaymentMethod === 'carte'" class="space-y-4 p-5 bg-blue-50 border border-blue-200 rounded-lg">
          <h3 class="text-lg font-bold text-blue-800">D√©tails de la Carte</h3>
          <div>
            <label class="block text-sm font-medium text-gray-700">Num√©ro de Carte</label>
            <input type="text" placeholder="xxxx xxxx xxxx xxxx" name="card_number_input"
                   [(ngModel)]="card_number" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-blue-500 focus:ring-blue-500">
          </div>
          <div class="grid grid-cols-3 gap-4">
            <div class="col-span-2">
              <label class="block text-sm font-medium text-gray-700">Date d'Expiration (MM/AA)</label>
              <input type="text" placeholder="01/25" name="card_expiry_input"
                     [(ngModel)]="card_expiry" required
                     class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-blue-500 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">CVV</label>
              <input type="text" placeholder="123" maxlength="3" name="card_cvv_input"
                     [(ngModel)]="card_cvv" required
                     class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-blue-500 focus:ring-blue-500">
            </div>
          </div>
        </div>

        <div *ngIf="selectedPaymentMethod === 'orange'" class="space-y-4 p-5 bg-orange-50 border border-orange-200 rounded-lg">
          <h3 class="text-lg font-bold text-orange-800">Paiement Orange-Money</h3>
          <div>
            <label class="block text-sm font-medium text-gray-700">Num√©ro Orange-Money</label>
            <input type="tel" placeholder="+221 77 XX XXX XX" name="orange_phone_input"
                   [(ngModel)]="orange_phone" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-orange-500 focus:ring-orange-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Code Pin / Validation</label>
            <input type="password" placeholder="Code secret de l'application mobile" name="orange_pin_input"
                   [(ngModel)]="orange_pin" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-orange-500 focus:ring-orange-500">
          </div>
        </div>

        <div *ngIf="selectedPaymentMethod === 'wave'" class="space-y-4 p-5 bg-teal-50 border border-teal-200 rounded-lg">
          <h3 class="text-lg font-bold text-teal-800">Paiement Wave</h3>
          <div>
            <label class="block text-sm font-medium text-gray-700">Num√©ro Wave</label>
            <input type="tel" placeholder="+221 76 XX XXX XX" name="wave_phone_input"
                   [(ngModel)]="wave_phone" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-teal-500 focus:ring-teal-500">
          </div>
          <p class="text-sm text-teal-700">Vous recevrez une notification sur votre t√©l√©phone pour valider le paiement.</p>
        </div>
      </div>

      <div class="mt-8">
        <button (click)="submitPayment()"
                [disabled]="!selectedPaymentMethod || !paymentAmount || paymentAmount <= 0"
                [ngClass]="{'bg-pink-600 hover:bg-pink-700': selectedPaymentMethod && paymentAmount > 0, 'bg-gray-400 cursor-not-allowed': !selectedPaymentMethod || paymentAmount <= 0}"
                class="w-full py-3 px-4 rounded-xl text-white font-semibold text-lg transition duration-150 ease-in-out shadow-lg disabled:opacity-50">
          {{ selectedPaymentMethod && paymentAmount > 0 ? ('Payer ' + (paymentAmount | number: '1.2-2') + ' ‚Ç¨ via ' + getFriendlyMethodName(selectedPaymentMethod)) : 'S√©lectionnez la m√©thode et le montant' }}
        </button>
      </div>

    </div>
  </section>

</main>
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

  <section id="list-view" *ngIf="currentView === 'list-view'">

    <section class="mb-10 text-center md:text-left">
      <h2 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-2">
        Garde d'Enfants <span class="childcare-color">üß∏</span>
      </h2>
      <p class="text-xl text-gray-500">Trouvez une nounou ou assistante maternelle qualifi√©e pr√®s de chez vous.</p>
    </section>

    <form (ngSubmit)="applyFilters()" class="bg-white p-6 rounded-xl shadow-lg mb-8 border border-gray-100">
      <h3 class="text-xl font-bold text-gray-800 mb-4">Affiner votre recherche</h3>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <input type="text" placeholder="Ville ou quartier (ex: Dakar)"
               [(ngModel)]="filterLocation" name="location"
               class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
        <select [(ngModel)]="filterAge" name="age"
                class="p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 appearance-none">
          <option value="all">Toutes tranches d'√¢ge</option>
          <option value="bebe">B√©b√©s (0-2 ans)</option>
          <option value="maternelle">Maternelle (3-5 ans)</option>
          <option value="primaire">Primaire (6-12 ans)</option>
        </select>
        <div class="flex items-center space-x-2 p-3 bg-gray-50 rounded-lg">
          <input type="checkbox" [(ngModel)]="filterUrgent" name="urgent"
                 class="w-4 h-4 text-pink-600 border-gray-300 rounded focus:ring-pink-500">
          <label for="filter-urgent" class="text-gray-700">Disponible Imm√©diatement</label>
        </div>
        <button type="submit" class="px-6 py-3 bg-pink-600 text-white font-bold rounded-lg shadow-md hover:bg-pink-700 transition duration-300">
          Appliquer les Filtres
        </button>
      </div>
    </form>

    <section>
      <h3 class="text-2xl font-bold text-gray-800 mb-6">
        {{ filteredProviders.length }} Prestataire(s) trouv√©(s)
      </h3>

      <div class="space-y-6">
        <div *ngFor="let nanny of filteredProviders"
             class="provider-card bg-white p-6 rounded-xl shadow-lg border-l-4 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0"
             [ngClass]="{'border-pink-500': nanny.availability === 'now', 'border-gray-300': nanny.availability !== 'now'}"
             [attr.data-id]="nanny.id">

          <div class="flex items-center space-x-4 w-full md:w-auto">
            <div class="w-16 h-16 rounded-full border-2 border-pink-500 flex items-center justify-center text-xl font-bold text-white bg-pink-500">
              {{ nanny.imgText }}
            </div>
            <div>
              <a href="#" (click)="showDetails(nanny.id)" class="text-xl font-bold text-gray-900 hover:text-pink-600 transition">{{ nanny.name }}</a>
              <p class="text-gray-600">{{ nanny.title }}</p>
              <div class="flex items-center mt-1">
                <span class="text-sm font-bold mr-1 text-gray-800">{{ nanny.rating }}</span>
                <span [innerHTML]="generateStars(nanny.rating)"></span>
                <span class="text-sm text-gray-500 ml-2">({{ nanny.reviews }} Avis)</span>
              </div>
            </div>
          </div>

          <div class="flex flex-col items-start md:items-end space-y-2">
            <div [ngClass]="{
                'text-pink-700 bg-pink-100': nanny.availability === 'now',
                'text-gray-700 bg-gray-100': nanny.availability !== 'now'
              }"
                 class="availability-status flex items-center font-semibold px-3 py-1 rounded-full text-sm">
              <span *ngIf="nanny.availability === 'now'" class="relative flex h-2 w-2 mr-2">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-pink-400 opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-2 w-2 bg-pink-500"></span>
              </span>
              {{ getAvailabilityText(nanny.availability) }}
            </div>
            <p class="text-2xl font-bold text-pink-600">{{ nanny.rate }}</p>
            <button (click)="showDetails(nanny.id)" class="px-5 py-2 bg-pink-600 text-white font-semibold rounded-lg hover:bg-pink-700 transition duration-300">
              Contacter
            </button>
          </div>
        </div>
      </div>

      <div *ngIf="filteredProviders.length === 0" class="text-center p-8 bg-pink-50 rounded-lg border border-pink-200 mt-6">
        <p class="text-xl text-pink-800 font-semibold">Aucun prestataire ne correspond √† vos crit√®res.</p>
      </div>
    </section>
  </section>

  <section id="detail-view" *ngIf="currentView === 'detail-view' && selectedNanny">
    <button (click)="showView('list-view')" class="text-pink-600 hover:text-pink-800 font-semibold mb-6 flex items-center">
      Retour √† la liste
    </button>

    <div id="detail-content" class="bg-white p-8 rounded-xl shadow-2xl">
      <div class="flex flex-col md:flex-row items-center md:items-start space-y-6 md:space-y-0 md:space-x-8">
        <div class="w-32 h-32 rounded-full border-4 border-pink-500 flex items-center justify-center text-3xl font-bold text-white bg-pink-500">{{ selectedNanny.imgText }}</div>
        <div>
          <h2 class="text-3xl font-bold text-gray-900 mb-1">{{ selectedNanny.name }}</h2>
          <p class="text-xl text-pink-600 mb-2">{{ selectedNanny.title }}</p>
          <p class="text-gray-700 mb-4">{{ selectedNanny.profileContent }}</p>
          <p class="text-2xl font-bold text-pink-600 mb-4">Tarif: {{ selectedNanny.rate }}</p>

          <div class="mt-6">
            <div *ngIf="selectedNanny.availability === 'now'">
              <button (click)="simulateReservationDemand(selectedNanny.id)"
                      class="px-8 py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-lg hover:bg-indigo-700 transition duration-300">
                Faire une demande de r√©servation
              </button>
            </div>

            <div *ngIf="selectedNanny.availability !== 'now'" class="p-4 bg-gray-100 rounded-lg">
              <p class="text-lg font-semibold text-gray-700">
                R√©servation imm√©diate impossible. Statut: **{{ getAvailabilityText(selectedNanny.availability) }}**.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="reservationAccepted" class="mt-8 p-6 bg-pink-50 border border-pink-200 rounded-xl">
      <h3 class="text-2xl font-bold text-pink-800 mb-4">Demande accept√©e ! üéâ</h3>
      <p class="text-gray-700 mb-4">Votre demande de r√©servation a √©t√© **accept√©e** par
        <span class="font-bold">{{ selectedNanny.name }}</span>.
      </p>
      <p class="text-lg font-semibold text-gray-800 mb-4">Montant initial sugg√©r√© :
        <span class="text-pink-600 font-bold">{{ paymentAmount | number: '1.2-2' }} ‚Ç¨</span> (√† ajuster au paiement)
      </p>

      <button (click)="showPaymentForm(selectedNanny.id, paymentAmount)"
              class="px-8 py-3 bg-pink-600 text-white font-bold rounded-lg hover:bg-pink-700 transition duration-300 w-full md:w-auto">
        Effectuer le Paiement Maintenant
      </button>
    </div>
  </section>

  <section id="payment-view" *ngIf="currentView === 'payment-view' && selectedNanny">
    <button (click)="showView('detail-view')" class="text-pink-600 hover:text-pink-800 font-semibold mb-6 flex items-center">
      Annuler et revenir √† la demande
    </button>

    <div class="w-full max-w-lg mx-auto bg-white p-6 sm:p-8 rounded-xl shadow-2xl">

      <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Paiement S√©curis√© <span class="childcare-color">üîí</span></h1>
      <p class="text-center text-gray-500 mb-6">Paiement pour <span class="font-semibold text-pink-600">{{ selectedNanny.name }}</span></p>

      <div class="mb-6 border-b pb-4 border-indigo-100">
        <label for="payment-montant" class="block text-sm font-medium text-gray-700 mb-2">Montant √† Payer (en ‚Ç¨)</label>
        <div class="relative rounded-lg shadow-sm">
          <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
            <span class="text-gray-500 sm:text-sm font-semibold">‚Ç¨</span>
          </div>
          <input type="number" id="payment-montant" name="montant" placeholder="55.00" min="0.01" step="0.01" required
                 [(ngModel)]="paymentAmount"
                 class="block w-full rounded-lg border-2 border-indigo-300 py-3 pl-10 pr-4 text-gray-900 placeholder:text-gray-400 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm sm:leading-6 transition duration-150 ease-in-out">
        </div>
      </div>

      <h2 class="text-xl font-semibold text-gray-700 mb-4">Choisir la m√©thode de paiement</h2>

      <div class="space-y-4 mb-8">
        <label class="flex items-center p-4 bg-blue-50 border-2 rounded-xl cursor-pointer has-[:checked]:border-blue-600">
          <input type="radio" name="payment_method" value="carte"
                 [(ngModel)]="selectedPaymentMethod"
                 class="form-radio h-5 w-5 text-blue-600">
          <span class="ml-3 text-lg font-medium text-gray-800">Carte Bancaire</span>
        </label>

        <label class="flex items-center p-4 bg-orange-50 border-2 rounded-xl cursor-pointer has-[:checked]:border-orange-600">
          <input type="radio" name="payment_method" value="orange"
                 [(ngModel)]="selectedPaymentMethod"
                 class="form-radio h-5 w-5 text-orange-600">
          <span class="ml-3 text-lg font-medium text-gray-800">Orange-Money</span>
        </label>

        <label class="flex items-center p-4 bg-teal-50 border-2 rounded-xl cursor-pointer has-[:checked]:border-teal-600">
          <input type="radio" name="payment_method" value="wave"
                 [(ngModel)]="selectedPaymentMethod"
                 class="form-radio h-5 w-5 text-teal-600">
          <span class="ml-3 text-lg font-medium text-gray-800">Wave</span>
        </label>
      </div>

      <div id="specific-fields-container">

        <div *ngIf="selectedPaymentMethod === 'carte'" class="space-y-4 p-5 bg-blue-50 border border-blue-200 rounded-lg">
          <h3 class="text-lg font-bold text-blue-800">D√©tails de la Carte</h3>
          <div>
            <label class="block text-sm font-medium text-gray-700">Num√©ro de Carte</label>
            <input type="text" placeholder="xxxx xxxx xxxx xxxx" name="card_number_input"
                   [(ngModel)]="card_number" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-blue-500 focus:ring-blue-500">
          </div>
          <div class="grid grid-cols-3 gap-4">
            <div class="col-span-2">
              <label class="block text-sm font-medium text-gray-700">Date d'Expiration (MM/AA)</label>
              <input type="text" placeholder="01/25" name="card_expiry_input"
                     [(ngModel)]="card_expiry" required
                     class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-blue-500 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">CVV</label>
              <input type="text" placeholder="123" maxlength="3" name="card_cvv_input"
                     [(ngModel)]="card_cvv" required
                     class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-blue-500 focus:ring-blue-500">
            </div>
          </div>
        </div>

        <div *ngIf="selectedPaymentMethod === 'orange'" class="space-y-4 p-5 bg-orange-50 border border-orange-200 rounded-lg">
          <h3 class="text-lg font-bold text-orange-800">Paiement Orange-Money</h3>
          <div>
            <label class="block text-sm font-medium text-gray-700">Num√©ro Orange-Money</label>
            <input type="tel" placeholder="+221 77 XX XXX XX" name="orange_phone_input"
                   [(ngModel)]="orange_phone" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-orange-500 focus:ring-orange-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Code Pin / Validation</label>
            <input type="password" placeholder="Code secret de l'application mobile" name="orange_pin_input"
                   [(ngModel)]="orange_pin" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-orange-500 focus:ring-orange-500">
          </div>
        </div>

        <div *ngIf="selectedPaymentMethod === 'wave'" class="space-y-4 p-5 bg-teal-50 border border-teal-200 rounded-lg">
          <h3 class="text-lg font-bold text-teal-800">Paiement Wave</h3>
          <div>
            <label class="block text-sm font-medium text-gray-700">Num√©ro Wave</label>
            <input type="tel" placeholder="+221 76 XX XXX XX" name="wave_phone_input"
                   [(ngModel)]="wave_phone" required
                   class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:border-teal-500 focus:ring-teal-500">
          </div>
          <p class="text-sm text-teal-700">Vous recevrez une notification sur votre t√©l√©phone pour valider le paiement.</p>
        </div>
      </div>

      <div class="mt-8">
        <button (click)="submitPayment()"
                [disabled]="!selectedPaymentMethod || !paymentAmount || paymentAmount <= 0"
                [ngClass]="{'bg-pink-600 hover:bg-pink-700': selectedPaymentMethod && paymentAmount > 0, 'bg-gray-400 cursor-not-allowed': !selectedPaymentMethod || paymentAmount <= 0}"
                class="w-full py-3 px-4 rounded-xl text-white font-semibold text-lg transition duration-150 ease-in-out shadow-lg disabled:opacity-50">
          {{ selectedPaymentMethod && paymentAmount > 0 ? ('Payer ' + (paymentAmount | number: '1.2-2') + ' ‚Ç¨ via ' + getFriendlyMethodName(selectedPaymentMethod)) : 'S√©lectionnez la m√©thode et le montant' }}
        </button>
      </div>

    </div>
  </section>

</main>
